(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/order"],{"33ef":function(t,e,a){"use strict";var n=a("e82b"),o=a.n(n);o.a},"56fc":function(t,e,a){"use strict";a.r(e);var n=a("b29d"),o=a.n(n);for(var r in n)"default"!==r&&function(t){a.d(e,t,function(){return n[t]})}(r);e["default"]=o.a},6913:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},o=[];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return o})},"8b12":function(t,e,a){"use strict";a.r(e);var n=a("6913"),o=a("56fc");for(var r in o)"default"!==r&&function(t){a.d(e,t,function(){return o[t]})}(r);a("33ef");var i=a("2877"),d=Object(i["a"])(o["default"],n["a"],n["b"],!1,null,null,null);e["default"]=d.exports},b29d:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;n(a("6324"));function n(t){return t&&t.__esModule?t:{default:t}}var o=function(){return a.e("components/uni-load-more/uni-load-more").then(a.bind(null,"ff1f"))},r=function(){return a.e("components/empty").then(a.bind(null,"c74b"))},i=function(){return a.e("components/min-badge/min-badge").then(a.bind(null,"c93a"))},d={components:{uniLoadMore:o,empty:r,minBadge:i},data:function(){return{tabCurrentIndex:0,navList:[{state:0,text:"全部单",loadingType:"more",orderList:[],page:1,size:10,count:0},{state:1,text:"待付款",loadingType:"more",orderList:[],page:1,size:10,count:0},{state:2,text:"待发货",loadingType:"more",orderList:[],page:1,size:10,count:0},{state:3,text:"待收货",loadingType:"more",orderList:[],page:1,size:10,count:0},{state:4,text:"已完成",loadingType:"more",orderList:[],page:1,size:10,count:0},{state:5,text:"已取消",loadingType:"more",orderList:[],page:1,size:10,count:0}]}},onLoad:function(t){},onShow:function(){this.loadCount();var t=this.tabCurrentIndex;this.navList[t];this.navList[t].orderList=[],this.navList[t].page=1,this.navList[t].loadingType="more",this.loadData("tabChange")},methods:{loadCount:function(){var t=this;t.$http({method:"GET",url:this.global.target+"/wx/order/onLinePayListCount"}).then(function(e){t.navList[0].count=e.data.data.myAllOrderCount,t.navList[1].count=e.data.data.myDaiFuKuanCount,t.navList[2].count=e.data.data.myDaiFaHuoCount,t.navList[3].count=e.data.data.myDaiShouHuoCount,t.navList[4].count=e.data.data.myYiWanChengCount,t.navList[5].count=e.data.data.myYiQuXiaoCount},function(t){})},toorderdetail:function(e){t.navigateTo({url:"/pages/order/orderdetail?goodsid="+e})},loadData:function(t){var e=this.tabCurrentIndex,a=this.navList[e],n=a.state,o=a.page,r=a.size;if("tabChange"===t&&!0===a.loaded&&(this.navList[e].orderList=[],this.navList[e].page=1,this.navList[e].loadingType="more"),"loading"!=a.loadingType&&"noMore"!=a.loadingType){a.loadingType="loading";var i=this;i.$http({method:"GET",params:{page:o,limit:r,showType:n},url:this.global.target+"/wx/order/list"}).then(function(t){var e=t.data;if(0==e.errno){var r=e.data.data,d=e.data.totalPages;r.forEach(function(t){return t=Object.assign(t,i.orderStateExp(t.state)),0===n?t:t.state===n}),r.forEach(function(t){a.orderList.push(t)}),i.$set(a,"loaded",!0),a.loadingType=o>=d?"noMore":"more",a.page=++o}else i.$api.msg(e.errmsg)},function(t){})}},changeTab:function(t){this.tabCurrentIndex=t.target.current,this.navList[t.target.current].page=1,this.loadData("tabChange")},tabClick:function(t){this.tabCurrentIndex=t,this.navList[t].page=1},deleteOrder:function(e){var a=this,n=this;n.$http({method:"POST",params:{orderId:e.id},url:this.global.target+"/wx/order/delete"}).then(function(t){var e=t.data;if(0==e.errno)e.data.data;else n.$api.msg(e.errmsg)},function(t){}),t.showLoading({title:"请稍后"}),setTimeout(function(){a.navList[a.tabCurrentIndex].orderList.splice(index,1),t.hideLoading()},600)},cancelOrder:function(e){var a=this;t.showModal({title:"",content:"确认取消订单吗？",success:function(n){n.confirm?a.$http({method:"POST",params:{orderId:e.id},url:a.global.target+"/wx/order/cancel"}).then(function(n){var o=n.data;if(0==o.errno){o.data;t.showLoading({title:"请稍后"}),setTimeout(function(){var n=a.orderStateExp(9),o=n.stateTip,r=n.stateTipColor;e=Object.assign(e,{state:9,stateTip:o,stateTipColor:r});var i=a.navList[1].orderList,d=i.findIndex(function(t){return t.id===e.id});-1!==d&&i.splice(d,1),t.hideLoading()},600)}else a.$api.msg(o.errmsg)},function(t){}):n.cancel}})},orderStateExp:function(t){var e="",a="#fa436a";switch(+t){case 101:e="待付款";break;case 201:e="待发货";break;case 401:case 402:e="订单已关闭",a="#909399";break;case 102:case 103:e="已取消",a="#909399";break}return{stateTip:e,stateTipColor:a}},orderDetail:function(e){console.log(9887),t.navigateTo({url:"/pages/order/orderdetail?id="+e})},orderTerminat:function(e){var a=this;t.showModal({title:"",content:"确认已经收货？",success:function(t){t.confirm?a.$http({method:"POST",params:{orderId:e},url:a.global.target+"/wx/order/confirm"}).then(function(t){t.data;a.orderDetail(e)},function(t){}):t.cancel}})},orderBack:function(e){var a=this;t.showModal({title:"",content:"确定要申请退款吗？",success:function(t){t.confirm?a.$http({method:"POST",params:{orderId:e},url:a.global.target+"/wx/order/refund"}).then(function(t){t.data;a.orderDetail(e)},function(t){}):t.cancel}})},navToPayPage:function(e){var a=e.id,n=e.orderSn,o=e.actualPrice;console.log(e),t.navigateTo({url:"/pages/money/pay?orderId="+a+"&ordersn="+n+"&pay="+o})},refund:function(t){var e=this;e.$http({method:"POST",params:{orderId:t},url:this.global.target+"/wx/order/refund"}).then(function(t){var a=t.data;if(0==a.errno)a.data;else e.$api.msg(a.errmsg)},function(t){})}}};e.default=d}).call(this,a("543d")["default"])},e82b:function(t,e,a){}},[["8a1d","common/runtime","common/vendor"]]]);