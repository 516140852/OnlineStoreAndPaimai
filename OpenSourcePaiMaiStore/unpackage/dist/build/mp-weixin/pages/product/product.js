(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/product/product"],{"0594":function(t,e,n){},"34cc":function(t,e,n){"use strict";n.r(e);var o=n("7b6d"),r=n("8c00");for(var i in r)"default"!==i&&function(t){n.d(e,t,function(){return r[t]})}(i);n("d34b");var u=n("2877"),s=Object(u["a"])(r["default"],o["a"],o["b"],!1,null,null,null);e["default"]=s.exports},"4cae":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n("a34a")),r=a(n("e893")),i=(a(n("f121")),a(n("d62c"))),u=a(n("f546")),s=n("2f62");function a(t){return t&&t.__esModule?t:{default:t}}function c(t,e,n,o,r,i,u){try{var s=t[i](u),a=s.value}catch(c){return void n(c)}s.done?e(a):Promise.resolve(a).then(o,r)}function d(t){return function(){var e=this,n=arguments;return new Promise(function(o,r){var i=t.apply(e,n);function u(t){c(i,o,r,u,s,"next",t)}function s(t){c(i,o,r,u,s,"throw",t)}u(void 0)})}}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(e){l(t,e,n[e])})}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var p=function(){return n.e("components/share").then(n.bind(null,"bf1c"))},h=function(){return n.e("components/uni-countdown/uni-countdown").then(n.bind(null,"5bb4"))},m={components:f({},(0,s.mapState)(["hasLogin","userInfo"]),{share:p,UniCountdown:h}),data:function(){return{normPrice:0,normStock:0,returnGrouponInfo:"",groupOnPersonCount:"",groupOnMinPersonCount:"",goodsId:0,productId:0,infomation:{attribute:"attribute",value:"value"},product:{},specClass:"none",specSelected:[{value:106,unit:1}],footflag:!0,favorite:!0,shareList:[],imgList:[],desc:"",specList:[{id:1,name:"尺寸"},{id:2,name:"颜色"}],productList:[{id:1,pid:1,name:"XS"},{id:9,pid:2,name:"草木绿"}],num_icon_add:r.default,num_icon_dis:u.default,goods_num:1,addtype:0}},onLoad:function(){var e=d(o.default.mark(function e(n){var r,i;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n.from&&(this.footflag=!1),r=n.id,this.goodsId=r,i=this,i.$http({method:"POST",params:{userId:t.getStorageSync("userInfo").id,id:r},url:this.global.target+"/wx/goods/detail"}).then(function(t){var e=t.data.data;i.infomation=e.attribute,i.imgList=e.info.gallery,i.product=e.info;var n=i.product.comId;i.footflag=1==n,i.desc="<div style='width:100vw'>"+e.info.detail+"</div>",i.specList=e.specificationList,i.productList=e.productList,i.specList.forEach(function(t){for(var e=t.valueList,n=0;n<e.length;n++){var o=e[n];i.$set(o,"selected",!0);break}}),i.refreshNorm()},function(t){}),e.next=7,this.$api.json("shareList");case 7:this.shareList=e.sent;case 8:case"end":return e.stop()}},e,this)}));function n(t){return e.apply(this,arguments)}return n}(),methods:f({},(0,s.mapMutations)(["login"]),{toggleSpec:function(t){this.specClass="show",this.addtype="tocart"==t?1:"tobuy"==t?2:0},untoggleSpec:function(){var t=this;this.specClass="hide",setTimeout(function(){t.specClass="none"},250),this.normStock<=0?this.$api.msg("库存数量为0"):1==this.addtype?(this.confimaddtocart(),this.getcartNumber()):2==this.addtype&&this.confimbuy()},refund:function(e){var n=this;n.$http({method:"POST",params:{userId:t.getStorageSync("userInfo").id,orderId:e},url:this.global.target+"/wx/order/refund"}).then(function(t){var e=t.data;if(0==e.errno)e.data.data;else n.$api.msg(e.errmsg)},function(t){})},selectSpec:function(t,e){for(var n=this,o=this.specList,r=0;r<o.length;r++){var i=o[r],u=i.valueList;u.forEach(function(o){r==t&&(o.value!=e?n.$set(o,"selected",!1):n.$set(o,"selected",!0))})}this.refreshNorm()},refreshNorm:function(){var t=this,e=this.productList,n=this.specList;this.specSelected=[];var o="";n.forEach(function(e){var n=e.valueList;n.forEach(function(e){!0===e.selected&&(t.specSelected.push(e),o+=e.value)})});this.specSelected;e.forEach(function(e){var n=e.specifications,r="";n.forEach(function(t){r+=t}),r==o&&(e.returnRuleNumber<=0?t.$api.msg("库存不足"):(t.normPrice=e.returnRulePrice,null!=e.returnRuleNumber?t.normStock=e.returnRuleNumber:t.normStock=e.number,t.returnGrouponInfo=e.returnGrouponInfo,null!=t.returnGrouponInfo&&(t.groupOnPersonCount=t.returnGrouponInfo.split("/")[0],t.groupOnMinPersonCount=t.returnGrouponInfo.split("/")[1]),t.productId=e.id,t.product.returnType=e.returnType,t.product.returnRuleId=e.returnRuleId,t.product.returnIfOnlyUserBonus=e.returnIfOnlyUserBonus,t.product.returnAllowBuyGoods=e.returnAllowBuyGoods,t.product.seckillEndDate=e.seckillEndDate,t.product.retailPrice=e.returnRulePrice,t.product.sourcePrice=e.returnRuleSourcePrice,t.goods_num>e.returnRuleNumber&&(t.goods_num=e.returnRuleNumber)))}),this.daotime()},share:function(){this.$refs.share.toggleMask()},toFavorite:function(){this.favorite=!this.favorite},buyClick:function(){this.toggleSpec("tobuy")},confimbuy:function(){if(this.normStock<=0)this.$api.msg("库存数量为0");else if(this.productId&&0!=this.productId){var e=10;"秒杀商品"==this.product.returnType?e=20:"团购商品"==this.product.returnType&&(e=30),t.navigateTo({url:"/pages/order/createOrder?productId="+this.productId+"&number="+this.goods_num+"&comId="+this.product.comId+"&mallOrderTypeCode="+e+"&ruleId="+this.product.returnRuleId+"&price="+this.normPrice+"&ifXuni="+this.product.ifXuni+"&returnIfOnlyUserBonus="+this.product.returnIfOnlyUserBonus})}else this.$api.msg("请选择商品")},addtocart:function(){this.toggleSpec("tocart")},confimaddtocart:function(){if(t.showLoading({title:"请稍后"}),this.productId&&0!=this.productId){var e=this;e.$http({method:"POST",params:{gid:e.goodsId,pid:e.productId,count:e.goods_num,price:e.normPrice},url:e.global.target+"/wx/cart/add"}).then(function(n){t.hideLoading(),0!=n.data.errno?e.$api.msg(n.data.errmsg):e.$api.msg("商品已加入购物车")},function(n){t.hideLoading(),e.$api.msg("请选择商品")})}else e.$api.msg("请选择商品")},stopPrevent:function(){},orderYuyue:function(){this.normStock<=0?this.$api.msg("库存数量为0"):this.productId&&0!=this.productId?t.navigateTo({url:"/pages/submitam/submitam?goodId="+this.productId+"&number="+this.goods_num+"&comId="+this.product.comId}):this.$api.msg("请选择商品")},addgood_num:function(){if(this.goods_num<this.normStock){var t={goods_num:""==this.goods_num?void 0:parseInt(this.goods_num)+1},e=t.goods_num,n=void 0===e?1:e;this.goods_num=n}},disgood_num:function(){if(this.goods_num>1){var t={goods_num:""==this.goods_num?void 0:parseInt(this.goods_num)-1},e=t.goods_num,n=void 0===e?1:e;this.goods_num=n}},tologin:function(){t.navigateTo({url:"/pages/public/tologin"})},kefu:function(){location.href="http://uclient.yunque360.com/frame.html?company_id=caat1hf0jv46"},daotime:function(){var t=this,e=this,n=Math.round((new Date).getTime()/1e3).toString();e.currenttime=n;var o=0;setInterval(function(){o+=1;var r=new Array,i=Date.parse(t.product.seckillEndDate)/1e3-n-o;r.push(i),i=i>0?i:0,e.product.seckilltimes=r,e.$forceUpdate()},1e3)},getcartNumber:function(){var e=this;e.$http({method:"GET",url:e.global.target+"/wx/cart/cartNumber"}).then(function(e){var n=e.data;0==n.errno&&(console.log(n),t.setTabBarBadge({index:3,text:""+n.data}))},function(t){})}}),watch:{goods_num:function(t){var e=this;t%1!=0?e.goods_num=parseInt(t):""!=t&&void 0!=t&&" "!=t||(e.goods_num=0),e.num_icon_dis=t>1?i.default:u.default}}};e.default=m}).call(this,n("543d")["default"])},"7b6d":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement;t._self._c},r=[];n.d(e,"a",function(){return o}),n.d(e,"b",function(){return r})},"8c00":function(t,e,n){"use strict";n.r(e);var o=n("4cae"),r=n.n(o);for(var i in o)"default"!==i&&function(t){n.d(e,t,function(){return o[t]})}(i);e["default"]=r.a},d34b:function(t,e,n){"use strict";var o=n("0594"),r=n.n(o);r.a}},[["b088","common/runtime","common/vendor"]]]);